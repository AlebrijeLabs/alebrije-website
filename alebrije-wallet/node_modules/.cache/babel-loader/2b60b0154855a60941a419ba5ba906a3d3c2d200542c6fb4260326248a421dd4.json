{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,Table,Badge,Spinner}from'react-bootstrap';import TransactionHistoryService from'../services/transaction-history-service';import WalletService from'../services/wallet-service';import{formatDistance}from'date-fns';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TransactionHistory=_ref=>{let{tokenAddress}=_ref;const[transactions,setTransactions]=useState([]);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const loadTransactions=async()=>{if(!WalletService.isConnected()){setError('Wallet not connected');return;}setIsLoading(true);setError(null);try{await TransactionHistoryService.initialize(tokenAddress);const txHistory=await TransactionHistoryService.fetchTransactionHistory(tokenAddress);setTransactions(txHistory);}catch(err){setError(err.message||'Failed to load transactions');console.error('Failed to load transactions:',err);}finally{setIsLoading(false);}};useEffect(()=>{if(WalletService.isConnected()){loadTransactions();}return()=>{TransactionHistoryService.cleanup();};},[tokenAddress]);const formatAddress=address=>{if(!address)return'';return`${address.substring(0,6)}...${address.substring(address.length-4)}`;};const formatTime=timestamp=>{if(!timestamp)return'';return formatDistance(new Date(timestamp),new Date(),{addSuffix:true});};return/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:\"Transaction History\"}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger\",children:[error,/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-link btn-sm float-end\",onClick:loadTransactions,children:\"Retry\"})]}),isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4\",children:[/*#__PURE__*/_jsx(Spinner,{animation:\"border\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2\",children:\"Loading transactions...\"})]}):transactions.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-muted p-4\",children:\"No transactions found\"}):/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{children:\"From/To\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:transactions.map(tx=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:tx.isIncoming?'success':'primary',children:tx.isIncoming?'Received':'Sent'})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:tx.isIncoming?'text-success':'text-primary',children:[tx.isIncoming?'+':'-',tx.value]})}),/*#__PURE__*/_jsx(\"td\",{children:tx.isIncoming?/*#__PURE__*/_jsxs(\"span\",{title:tx.from,children:[\"From: \",formatAddress(tx.from)]}):/*#__PURE__*/_jsxs(\"span\",{title:tx.to,children:[\"To: \",formatAddress(tx.to)]})}),/*#__PURE__*/_jsx(\"td\",{children:formatTime(tx.timestamp)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:tx.status==='confirmed'?'success':tx.status==='pending'?'warning':'danger',children:tx.status})})]},tx.hash))})]})})]})});};export default TransactionHistory;","map":{"version":3,"names":["React","useState","useEffect","Card","Table","Badge","Spinner","TransactionHistoryService","WalletService","formatDistance","jsx","_jsx","jsxs","_jsxs","TransactionHistory","_ref","tokenAddress","transactions","setTransactions","isLoading","setIsLoading","error","setError","loadTransactions","isConnected","initialize","txHistory","fetchTransactionHistory","err","message","console","cleanup","formatAddress","address","substring","length","formatTime","timestamp","Date","addSuffix","children","Body","Title","className","onClick","animation","hover","map","tx","bg","isIncoming","value","title","from","to","status","hash"],"sources":["/Users/rastavo/alebrije-project/alebrije-wallet/src/components/TransactionHistory.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Card, Table, Badge, Spinner } from 'react-bootstrap';\nimport TransactionHistoryService from '../services/transaction-history-service';\nimport WalletService from '../services/wallet-service';\nimport { formatDistance } from 'date-fns';\n\nconst TransactionHistory = ({ tokenAddress }) => {\n  const [transactions, setTransactions] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  \n  const loadTransactions = async () => {\n    if (!WalletService.isConnected()) {\n      setError('Wallet not connected');\n      return;\n    }\n    \n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      await TransactionHistoryService.initialize(tokenAddress);\n      const txHistory = await TransactionHistoryService.fetchTransactionHistory(tokenAddress);\n      setTransactions(txHistory);\n    } catch (err) {\n      setError(err.message || 'Failed to load transactions');\n      console.error('Failed to load transactions:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  useEffect(() => {\n    if (WalletService.isConnected()) {\n      loadTransactions();\n    }\n    \n    return () => {\n      TransactionHistoryService.cleanup();\n    };\n  }, [tokenAddress]);\n  \n  const formatAddress = (address) => {\n    if (!address) return '';\n    return `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;\n  };\n  \n  const formatTime = (timestamp) => {\n    if (!timestamp) return '';\n    return formatDistance(new Date(timestamp), new Date(), { addSuffix: true });\n  };\n  \n  return (\n    <Card>\n      <Card.Body>\n        <Card.Title>Transaction History</Card.Title>\n        \n        {error && (\n          <div className=\"alert alert-danger\">\n            {error}\n            <button \n              className=\"btn btn-link btn-sm float-end\" \n              onClick={loadTransactions}\n            >\n              Retry\n            </button>\n          </div>\n        )}\n        \n        {isLoading ? (\n          <div className=\"text-center p-4\">\n            <Spinner animation=\"border\" />\n            <p className=\"mt-2\">Loading transactions...</p>\n          </div>\n        ) : transactions.length === 0 ? (\n          <div className=\"text-center text-muted p-4\">\n            No transactions found\n          </div>\n        ) : (\n          <div className=\"table-responsive\">\n            <Table hover>\n              <thead>\n                <tr>\n                  <th>Type</th>\n                  <th>Amount</th>\n                  <th>From/To</th>\n                  <th>Time</th>\n                  <th>Status</th>\n                </tr>\n              </thead>\n              <tbody>\n                {transactions.map((tx) => (\n                  <tr key={tx.hash}>\n                    <td>\n                      <Badge bg={tx.isIncoming ? 'success' : 'primary'}>\n                        {tx.isIncoming ? 'Received' : 'Sent'}\n                      </Badge>\n                    </td>\n                    <td>\n                      <span className={tx.isIncoming ? 'text-success' : 'text-primary'}>\n                        {tx.isIncoming ? '+' : '-'}{tx.value}\n                      </span>\n                    </td>\n                    <td>\n                      {tx.isIncoming ? (\n                        <span title={tx.from}>From: {formatAddress(tx.from)}</span>\n                      ) : (\n                        <span title={tx.to}>To: {formatAddress(tx.to)}</span>\n                      )}\n                    </td>\n                    <td>{formatTime(tx.timestamp)}</td>\n                    <td>\n                      <Badge \n                        bg={\n                          tx.status === 'confirmed' ? 'success' : \n                          tx.status === 'pending' ? 'warning' : \n                          'danger'\n                        }\n                      >\n                        {tx.status}\n                      </Badge>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </Table>\n          </div>\n        )}\n      </Card.Body>\n    </Card>\n  );\n};\n\nexport default TransactionHistory; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}