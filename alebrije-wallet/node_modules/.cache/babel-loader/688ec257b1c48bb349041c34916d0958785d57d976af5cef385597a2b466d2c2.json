{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { LitElement, html } from 'lit';\nimport { state } from 'lit/decorators.js';\nimport { ChainController, ConnectionController, CoreHelperUtil, EventsController, ModalController, OptionsController, RouterController, SnackController } from '@reown/appkit-controllers';\nimport { customElement } from '@reown/appkit-ui';\nimport '../../partials/w3m-connecting-header/index.js';\nimport '../../partials/w3m-connecting-wc-browser/index.js';\nimport '../../partials/w3m-connecting-wc-desktop/index.js';\nimport '../../partials/w3m-connecting-wc-mobile/index.js';\nimport '../../partials/w3m-connecting-wc-qrcode/index.js';\nimport '../../partials/w3m-connecting-wc-unsupported/index.js';\nimport '../../partials/w3m-connecting-wc-web/index.js';\nlet W3mConnectingWcView = class W3mConnectingWcView extends LitElement {\n  constructor() {\n    super();\n    this.wallet = RouterController.state.data?.wallet;\n    this.platform = undefined;\n    this.platforms = [];\n    this.isSiwxEnabled = Boolean(OptionsController.state.siwx);\n    this.determinePlatforms();\n    this.initializeConnection();\n  }\n  render() {\n    return html`\n      ${this.headerTemplate()}\n      <div>${this.platformTemplate()}</div>\n      <wui-ux-by-reown></wui-ux-by-reown>\n    `;\n  }\n  async initializeConnection() {\n    let retry = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    if (this.platform === 'browser' || OptionsController.state.manualWCControl && !retry) {\n      return;\n    }\n    try {\n      const {\n        wcPairingExpiry,\n        status\n      } = ConnectionController.state;\n      if (retry || CoreHelperUtil.isPairingExpired(wcPairingExpiry) || status === 'connecting') {\n        await ConnectionController.connectWalletConnect();\n        if (!this.isSiwxEnabled) {\n          ModalController.close();\n        }\n      }\n    } catch (error) {\n      EventsController.sendEvent({\n        type: 'track',\n        event: 'CONNECT_ERROR',\n        properties: {\n          message: error?.message ?? 'Unknown'\n        }\n      });\n      ConnectionController.setWcError(true);\n      SnackController.showError(error.message ?? 'Connection error');\n      ConnectionController.resetWcConnection();\n      RouterController.goBack();\n    }\n  }\n  determinePlatforms() {\n    if (!this.wallet) {\n      this.platforms.push('qrcode');\n      this.platform = 'qrcode';\n      return;\n    }\n    if (this.platform) {\n      return;\n    }\n    const {\n      mobile_link,\n      desktop_link,\n      webapp_link,\n      injected,\n      rdns\n    } = this.wallet;\n    const injectedIds = injected?.map(_ref => {\n      let {\n        injected_id\n      } = _ref;\n      return injected_id;\n    }).filter(Boolean);\n    const browserIds = [...(rdns ? [rdns] : injectedIds ?? [])];\n    const isBrowser = OptionsController.state.isUniversalProvider ? false : browserIds.length;\n    const isMobileWc = mobile_link;\n    const isWebWc = webapp_link;\n    const isBrowserInstalled = ConnectionController.checkInstalled(browserIds);\n    const isBrowserWc = isBrowser && isBrowserInstalled;\n    const isDesktopWc = desktop_link && !CoreHelperUtil.isMobile();\n    if (isBrowserWc && !ChainController.state.noAdapters) {\n      this.platforms.push('browser');\n    }\n    if (isMobileWc) {\n      this.platforms.push(CoreHelperUtil.isMobile() ? 'mobile' : 'qrcode');\n    }\n    if (isWebWc) {\n      this.platforms.push('web');\n    }\n    if (isDesktopWc) {\n      this.platforms.push('desktop');\n    }\n    if (!isBrowserWc && isBrowser && !ChainController.state.noAdapters) {\n      this.platforms.push('unsupported');\n    }\n    this.platform = this.platforms[0];\n  }\n  platformTemplate() {\n    switch (this.platform) {\n      case 'browser':\n        return html`<w3m-connecting-wc-browser></w3m-connecting-wc-browser>`;\n      case 'web':\n        return html`<w3m-connecting-wc-web></w3m-connecting-wc-web>`;\n      case 'desktop':\n        return html`\n          <w3m-connecting-wc-desktop .onRetry=${() => this.initializeConnection(true)}>\n          </w3m-connecting-wc-desktop>\n        `;\n      case 'mobile':\n        return html`\n          <w3m-connecting-wc-mobile isMobile .onRetry=${() => this.initializeConnection(true)}>\n          </w3m-connecting-wc-mobile>\n        `;\n      case 'qrcode':\n        return html`<w3m-connecting-wc-qrcode></w3m-connecting-wc-qrcode>`;\n      default:\n        return html`<w3m-connecting-wc-unsupported></w3m-connecting-wc-unsupported>`;\n    }\n  }\n  headerTemplate() {\n    const multiPlatform = this.platforms.length > 1;\n    if (!multiPlatform) {\n      return null;\n    }\n    return html`\n      <w3m-connecting-header\n        .platforms=${this.platforms}\n        .onSelectPlatfrom=${this.onSelectPlatform.bind(this)}\n      >\n      </w3m-connecting-header>\n    `;\n  }\n  async onSelectPlatform(platform) {\n    const container = this.shadowRoot?.querySelector('div');\n    if (container) {\n      await container.animate([{\n        opacity: 1\n      }, {\n        opacity: 0\n      }], {\n        duration: 200,\n        fill: 'forwards',\n        easing: 'ease'\n      }).finished;\n      this.platform = platform;\n      container.animate([{\n        opacity: 0\n      }, {\n        opacity: 1\n      }], {\n        duration: 200,\n        fill: 'forwards',\n        easing: 'ease'\n      });\n    }\n  }\n};\n__decorate([state()], W3mConnectingWcView.prototype, \"platform\", void 0);\n__decorate([state()], W3mConnectingWcView.prototype, \"platforms\", void 0);\n__decorate([state()], W3mConnectingWcView.prototype, \"isSiwxEnabled\", void 0);\nW3mConnectingWcView = __decorate([customElement('w3m-connecting-wc-view')], W3mConnectingWcView);\nexport { W3mConnectingWcView };","map":{"version":3,"names":["LitElement","html","state","ChainController","ConnectionController","CoreHelperUtil","EventsController","ModalController","OptionsController","RouterController","SnackController","customElement","W3mConnectingWcView","constructor","wallet","data","platform","undefined","platforms","isSiwxEnabled","Boolean","siwx","determinePlatforms","initializeConnection","render","headerTemplate","platformTemplate","retry","arguments","length","manualWCControl","wcPairingExpiry","status","isPairingExpired","connectWalletConnect","close","error","sendEvent","type","event","properties","message","setWcError","showError","resetWcConnection","goBack","push","mobile_link","desktop_link","webapp_link","injected","rdns","injectedIds","map","_ref","injected_id","filter","browserIds","isBrowser","isUniversalProvider","isMobileWc","isWebWc","isBrowserInstalled","checkInstalled","isBrowserWc","isDesktopWc","isMobile","noAdapters","multiPlatform","onSelectPlatform","bind","container","shadowRoot","querySelector","animate","opacity","duration","fill","easing","finished","__decorate"],"sources":["../../../../../src/views/w3m-connecting-wc-view/index.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}